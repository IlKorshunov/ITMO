# üöÅ Dronoport

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –∏–∑ –ø—É–Ω–∫—Ç–∞ 1 (–∞–Ω–∞–ª–∏–∑ –∏ –≤—ã–∫–ª–∞–¥–∫–∏) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ [`demo`](./demo), –≤–∫–ª—é—á–∞—è –Ω–æ—É—Ç–±—É–∫–∏ `demo.ipynb` –∏ `lambda.ipynb`.

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ä–µ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥—Ä–æ–Ω–æ–º –∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (RL). –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É, –ø–æ–¥–±–æ—Ä—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é –∞–≥–µ–Ω—Ç–æ–≤.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
Dronoport/
‚îú‚îÄ‚îÄ agents/             # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ RL –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ q_learning.py
‚îÇ   ‚îú‚îÄ‚îÄ double_q_learning.py
‚îÇ   ‚îú‚îÄ‚îÄ sarsa.py
‚îÇ   ‚îú‚îÄ‚îÄ expected_sarsa.py
‚îÇ   ‚îú‚îÄ‚îÄ ucb_agent.py
‚îÇ   ‚îî‚îÄ‚îÄ prospect_agent.py
‚îú‚îÄ‚îÄ environment/        # –°—Ä–µ–¥–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ –¥—Ä–æ–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ drone_env.py
‚îÇ   ‚îú‚îÄ‚îÄ obstacles.py
‚îÇ   ‚îî‚îÄ‚îÄ wind.py
‚îú‚îÄ‚îÄ training/           # –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ trainer.py
‚îú‚îÄ‚îÄ evaluation/         # –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ evaluator.py
‚îú‚îÄ‚îÄ visualization/      # –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ plots.py
‚îú‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ discretizer.py
‚îÇ   ‚îî‚îÄ‚îÄ hyperopt.py
‚îú‚îÄ‚îÄ config/             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ demo/               # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–æ—É—Ç–±—É–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ demo.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ lambda.ipynb
‚îú‚îÄ‚îÄ results/            # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îî‚îÄ‚îÄ requirements.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üöÄ –ó–∞–ø—É—Å–∫

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∑–∞–ø—É—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python main.py
```

## ü§ñ –ê–≥–µ–Ω—Ç—ã

> –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö –∫—É—Ä—Å–∞ [Practical RL](https://github.com/yandexdataschool/Practical_RL) (–®–ê–î).

| –ê–≥–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **Q-Learning** | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ç–∞–±–ª–∏—á–Ω—ã–π off-policy –∞–ª–≥–æ—Ä–∏—Ç–º —Å $\epsilon$-greedy —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π. |
| **Double Q-Learning** | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è Q-Learning —Å –¥–≤—É–º—è Q-—Ç–∞–±–ª–∏—Ü–∞–º–∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è overestimation bias. |
| **SARSA** | On-policy TD(0) –∞–ª–≥–æ—Ä–∏—Ç–º, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –¥–µ–π—Å—Ç–≤–∏–µ, –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Ç–µ–∫—É—â–µ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π. |
| **Expected SARSA** | –í–∞—Ä–∏–∞—Ü–∏—è SARSA, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –ø–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º. |
| **UCB** | Q-Learning —Å UCB-—Ä–∞–∑–≤–µ–¥–∫–æ–π. |
| **Prospect Theory** | –ê–≥–µ–Ω—Ç, –º–æ–¥–µ–ª–∏—Ä—É—é—â–∏–π –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫—É—é —ç–∫–æ–Ω–æ–º–∏–∫—É —Å —Ñ—É–Ω–∫—Ü–∏–µ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –ø–æ—Ç–µ—Ä—è–º $\lambda=2.35$). |

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `main.py` —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `results/`:

```
results/
‚îú‚îÄ‚îÄ comparison/
‚îÇ   ‚îú‚îÄ‚îÄ all_agents_bars.png       # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥ (—Å—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞)
‚îÇ   ‚îî‚îÄ‚îÄ all_agents_table.png      # –¢–∞–±–ª–∏—Ü–∞ –º–µ—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ results.csv               # –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ training_history.csv      # –ò—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ hyperopt/
‚îÇ   ‚îî‚îÄ‚îÄ best_params.json          # –õ—É—á—à–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚îú‚îÄ‚îÄ learning/
‚îÇ   ‚îî‚îÄ‚îÄ all_agents_learning.png   # –ö—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ trajectories/                 # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π
    ‚îú‚îÄ‚îÄ all_agents_best.png
    ‚îú‚îÄ‚îÄ qlearning_trajectories.png
    ‚îú‚îÄ‚îÄ ...
```
